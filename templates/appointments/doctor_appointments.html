<!-- templates/appointments/doctor_appointments.html -->
{% extends "base.html" %}

{% block content %}
<section class="max-w-6xl mx-auto py-12 px-6">

  <h1 class="text-3xl font-semibold text-gray-800 mb-8">
    Your Appointments
  </h1>

  <div class="overflow-x-auto bg-white shadow-lg rounded-xl border border-gray-100">
    <table class="min-w-full text-sm">
      <thead class="bg-gray-50">
        <tr class="text-left text-gray-700 uppercase tracking-wider">
          <th class="px-6 py-4">Patient</th>
          <th class="px-6 py-4">Contact</th>
          <th class="px-6 py-4">Service</th>
          <th class="px-6 py-4">Date & Time</th>
          <th class="px-6 py-4">Status</th>
          <th class="px-6 py-4">Actions</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-200">
        {% for a in appointments %}
        <tr class="hover:bg-gray-50">

          <!-- Patient -->
          <td class="px-6 py-4 font-medium text-gray-900">
            {{ a.patient_name }}
          </td>

          <!-- Contact -->
          <td class="px-6 py-4 text-gray-600">
            <div>{{ a.patient_email }}</div>
            {% if a.patient_phone %}
              <div class="text-xs text-gray-500">{{ a.patient_phone }}</div>
            {% endif %}
          </td>

          <!-- Service -->
          <td class="px-6 py-4">
            {{ a.service.name }}
          </td>

          <!-- Date & Time -->
          <td class="px-6 py-4 text-gray-600">
            {% if a.availability %}
              <div>{{ a.availability.date|date:"M j, Y" }}</div>
              <div class="text-xs text-gray-500">
                {{ a.availability.start_time }} – {{ a.availability.end_time }}
              </div>
            {% else %}
              <span class="text-xs text-red-500">Not scheduled</span>
            {% endif %}
          </td>

          <!-- Status -->
          <td class="px-6 py-4">
            {% if a.status == "pending" %}
              <span class="px-3 py-1 text-xs bg-yellow-100 text-yellow-700 rounded-full">
                Pending
              </span>
            {% elif a.status == "confirmed" %}
              <span class="px-3 py-1 text-xs bg-green-100 text-green-700 rounded-full">
                Confirmed
              </span>
            {% elif a.status == "cancelled" %}
              <span class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded-full">
                Cancelled
              </span>
            {% else %}
              <span class="px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full">
                Completed
              </span>
            {% endif %}
          </td>

          <!-- Actions -->
          <td class="px-6 py-4 space-x-2">
            {% if a.status == "pending" %}
              <form method="post" action="{% url 'appointments:confirm' a.pk %}" class="inline">
                {% csrf_token %}
                <button
                  class="px-3 py-1 text-xs bg-green-600 hover:bg-green-700 text-white rounded">
                  Confirm
                </button>
              </form>

              <form method="post" action="{% url 'appointments:cancel' a.pk %}" class="inline">
                {% csrf_token %}
                <button
                  class="px-3 py-1 text-xs bg-red-600 hover:bg-red-700 text-white rounded">
                  Cancel
                </button>
              </form>
            {% else %}
              <span class="text-xs text-gray-400">—</span>
            {% endif %}
          </td>

        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center py-10 text-gray-500">
            No appointments yet.
          </td>
        </tr>
        {% endfor %}
      </tbody>

    </table>
  </div>

</section>
{% endblock %}
